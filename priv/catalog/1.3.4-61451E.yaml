id: 61451E
name: SBD required devices
# name: 1.3.4
group: SBD
description: |
  Multiple SBD devices are configured

  Not applicable to GCP, AWS
remediation: |
  ## Abstract
  It is recommended to configure 3 SBD devices for production environments.

  The SBD is not used in GCP or AWS environments.

  ## References
  Azure:

    -  https://docs.microsoft.com/en-us/azure/virtual-machines/workloads/sap/high-availability-guide-suse-pacemaker#set-up-sbd-device

  AWS:

  GCP:

  SUSE / KVM:

    - https://documentation.suse.com/sbp/all/single-html/SLES4SAP-hana-sr-guide-PerfOpt-15/#cha.hana-sr.scenario

run_when: env.provider != "aws" && env.provider != "gcp"

# CFSA-876
facts:
  - name: sbd_devices
    gatherer: sbd_devices

expectations:
  - name: sbd_devices_correctly_configured
    expect: len(facts.sbd_devices) == 3
