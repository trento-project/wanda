{"components":{"responses":{},"schemas":{"AcceptedExecutionResponse":{"description":"Identifiers of the recently accepted execution","properties":{"execution_id":{"format":"uuid","type":"string","x-struct":null,"x-validate":null},"group_id":{"format":"uuid","type":"string","x-struct":null,"x-validate":null}},"title":"AcceptedExecutionResponse","type":"object","x-struct":"Elixir.WandaWeb.Schemas.AcceptedExecutionResponse","x-validate":null},"AgentCheckError":{"description":"An error describing that some of the facts could not be gathered on a specific agent eg. gathering failure or timeout","properties":{"agent_id":{"description":"Agent ID","format":"uuid","type":"string","x-struct":null,"x-validate":null},"facts":{"description":"Facts gathered, possibly with errors, from the target","items":{"oneOf":[{"$ref":"#/components/schemas/Fact"},{"$ref":"#/components/schemas/FactError"}],"x-struct":null,"x-validate":null},"nullable":true,"type":"array","x-struct":null,"x-validate":null},"message":{"description":"Error message","type":"string","x-struct":null,"x-validate":null},"type":{"description":"Error type","type":"string","x-struct":null,"x-validate":null}},"required":["agent_id","type","message"],"title":"AgentCheckError","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.AgentCheckError","x-validate":null},"AgentCheckResult":{"description":"The result of check on a specific agent","properties":{"agent_id":{"description":"Agent ID","format":"uuid","type":"string","x-struct":null,"x-validate":null},"expectation_evaluations":{"description":"Result of the single expectation evaluation","items":{"oneOf":[{"$ref":"#/components/schemas/ExpectationEvaluation"},{"$ref":"#/components/schemas/ExpectationEvaluationError"}],"x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null},"facts":{"description":"Facts gathered from the targets","items":{"$ref":"#/components/schemas/Fact"},"type":"array","x-struct":null,"x-validate":null}},"required":["agent_id","facts","expectation_evaluations"],"title":"AgentCheckResult","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.AgentCheckResult","x-validate":null},"BadRequest":{"properties":{"errors":{"items":{"properties":{"detail":{"example":"Invalid request payload.","type":"string","x-struct":null,"x-validate":null},"title":{"example":"Bad Request","type":"string","x-struct":null,"x-validate":null}},"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null}},"title":"BadRequest","type":"object","x-struct":"Elixir.WandaWeb.Schemas.BadRequest","x-validate":null},"CatalogResponse":{"description":"Checks catalog listing response","properties":{"items":{"description":"List of catalog checks","items":{"$ref":"#/components/schemas/Check"},"type":"array","x-struct":null,"x-validate":null}},"title":"CatalogResponse","type":"object","x-struct":"Elixir.WandaWeb.Schemas.CatalogResponse","x-validate":null},"Check":{"description":"A single check from the catalog","properties":{"expectations":{"items":{"properties":{"expression":{"description":"Expression to be evaluated to get the expectation result","type":"string","x-struct":null,"x-validate":null},"failure_message":{"description":"Message returned when the check fails","nullable":true,"type":"string","x-struct":null,"x-validate":null},"name":{"description":"Expecation name","type":"string","x-struct":null,"x-validate":null},"type":{"description":"Expectation type","enum":["expect","expect_same"],"type":"string","x-struct":null,"x-validate":null}},"required":["name","type","expression"],"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null},"facts":{"items":{"properties":{"argument":{"description":"Argument for the gatherer","type":"string","x-struct":null,"x-validate":null},"gatherer":{"description":"Used gatherer","type":"string","x-struct":null,"x-validate":null},"name":{"description":"Fact name","type":"string","x-struct":null,"x-validate":null}},"required":["name","gatherer","argument"],"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null},"id":{"description":"Check ID","type":"string","x-struct":null,"x-validate":null},"name":{"description":"Check name","type":"string","x-struct":null,"x-validate":null},"premium":{"description":"Check is Premium or not","type":"boolean","x-struct":null,"x-validate":null},"severity":{"description":"Check severity: critical|warning","enum":["critical","warning"],"type":"string","x-struct":null,"x-validate":null},"values":{"items":{"properties":{"conditions":{"items":{"properties":{"expression":{"description":"Expression to be evaluated to use the current value","type":"string","x-struct":null,"x-validate":null},"value":{"description":"Value for this condition","oneOf":[{"type":"string","x-struct":null,"x-validate":null},{"type":"number","x-struct":null,"x-validate":null},{"type":"boolean","x-struct":null,"x-validate":null}],"x-struct":null,"x-validate":null}},"required":["value","expression"],"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null},"default":{"description":"Default value. Used if none of the conditions matches","oneOf":[{"type":"string","x-struct":null,"x-validate":null},{"type":"number","x-struct":null,"x-validate":null},{"type":"boolean","x-struct":null,"x-validate":null}],"x-struct":null,"x-validate":null},"name":{"description":"Value name","type":"string","x-struct":null,"x-validate":null}},"required":["name","default","conditions"],"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null},"when":{"description":"Expression to determine whether a check should run","nullable":true,"type":"string","x-struct":null,"x-validate":null}},"required":["id","name","severity","facts","values","expectations"],"title":"Check","type":"object","x-struct":"Elixir.WandaWeb.Schemas.CatalogResponse.Check","x-validate":null},"CheckResult":{"description":"The result of a check","properties":{"agents_check_results":{"items":{"oneOf":[{"$ref":"#/components/schemas/AgentCheckResult"},{"$ref":"#/components/schemas/AgentCheckError"}],"x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null},"check_id":{"description":"Check ID","type":"string","x-struct":null,"x-validate":null},"expectation_results":{"items":{"$ref":"#/components/schemas/ExpectationResult"},"type":"array","x-struct":null,"x-validate":null},"result":{"description":"Result of the check","enum":["passing","warning","critical"],"type":"string","x-struct":null,"x-validate":null}},"required":["check_id","expectation_results","agents_check_results","result"],"title":"CheckResult","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.CheckResult","x-validate":null},"ExecutionEnv":{"additionalProperties":{"oneOf":[{"type":"string","x-struct":null,"x-validate":null},{"type":"integer","x-struct":null,"x-validate":null},{"type":"boolean","x-struct":null,"x-validate":null},{"items":{"$ref":"#/components/schemas/ExecutionEnv"},"type":"array","x-struct":null,"x-validate":null}],"x-struct":null,"x-validate":null},"description":"Contextual Environment for the current execution","title":"ExecutionEnv","type":"object","x-struct":null,"x-validate":null},"ExecutionResponse":{"description":"The representation of an execution, it may be a running or completed one","properties":{"check_results":{"items":{"$ref":"#/components/schemas/CheckResult"},"nullable":true,"type":"array","x-struct":null,"x-validate":null},"completed_at":{"description":"Execution completion time","format":"date-time","nullable":true,"type":"string","x-struct":null,"x-validate":null},"critical_count":{"description":"Number of checks with critical result","nullable":true,"type":"integer","x-struct":null,"x-validate":null},"execution_id":{"description":"Execution ID","format":"uuid","type":"string","x-struct":null,"x-validate":null},"group_id":{"description":"Group ID","format":"uuid","type":"string","x-struct":null,"x-validate":null},"passing_count":{"description":"Number of checks with passing result","nullable":true,"type":"integer","x-struct":null,"x-validate":null},"result":{"description":"Aggregated result of the execution, unknown for running ones","enum":["passing","warning","critical"],"nullable":true,"type":"string","x-struct":null,"x-validate":null},"started_at":{"description":"Execution start time","format":"date-time","type":"string","x-struct":null,"x-validate":null},"status":{"description":"The status of the current execution","enum":["running","completed"],"type":"string","x-struct":null,"x-validate":null},"targets":{"items":{"$ref":"#/components/schemas/Target"},"type":"array","x-struct":null,"x-validate":null},"timeout":{"description":"Timed out agents","items":{"description":"Agent ID","format":"uuid","type":"string","x-struct":null,"x-validate":null},"nullable":true,"type":"array","x-struct":null,"x-validate":null},"warning_count":{"description":"Number of checks with warning result","nullable":true,"type":"integer","x-struct":null,"x-validate":null}},"required":["execution_id","group_id","status","started_at","completed_at","result","targets","critical_count","warning_count","passing_count","timeout","check_results"],"title":"ExecutionResponse","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse","x-validate":null},"ExpectationEvaluation":{"description":"Evaluation of an expectation","properties":{"failure_message":{"description":"Failure message. Only available for `expect` scenarios","nullable":true,"type":"string","x-struct":null,"x-validate":null},"name":{"description":"Name","type":"string","x-struct":null,"x-validate":null},"return_value":{"description":"Return value","oneOf":[{"type":"string","x-struct":null,"x-validate":null},{"type":"number","x-struct":null,"x-validate":null},{"type":"boolean","x-struct":null,"x-validate":null}],"x-struct":null,"x-validate":null},"type":{"description":"Evaluation type","enum":["expect","expect_same"],"type":"string","x-struct":null,"x-validate":null}},"required":["name","return_value","type"],"title":"ExpectationEvaluation","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.ExpectationEvaluation","x-validate":null},"ExpectationEvaluationError":{"description":"An error occurred during the evaluation of an expectation","properties":{"message":{"description":"Error message","type":"string","x-struct":null,"x-validate":null},"name":{"description":"Expectation name","type":"string","x-struct":null,"x-validate":null},"type":{"description":"Error type","type":"string","x-struct":null,"x-validate":null}},"required":["name","message","type"],"title":"ExpectationEvaluationError","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.ExpectationEvaluationError","x-validate":null},"ExpectationResult":{"description":"The result of an expectation","properties":{"failure_message":{"description":"Failure message. Only available for `expect_same` scenarios","nullable":true,"type":"string","x-struct":null,"x-validate":null},"name":{"description":"Expectation name","type":"string","x-struct":null,"x-validate":null},"result":{"description":"Result of the expectation condition","type":"boolean","x-struct":null,"x-validate":null},"type":{"description":"Evaluation type","enum":["expect","expect_same"],"type":"string","x-struct":null,"x-validate":null}},"required":["name","result","type"],"title":"ExpectationResult","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.ExpectationResult","x-validate":null},"Fact":{"description":"The result of a check","properties":{"check_id":{"description":"Check ID","type":"string","x-struct":null,"x-validate":null},"name":{"description":"Name","type":"string","x-struct":null,"x-validate":null},"value":{"description":"Value","oneOf":[{"type":"string","x-struct":null,"x-validate":null},{"type":"number","x-struct":null,"x-validate":null},{"type":"boolean","x-struct":null,"x-validate":null},{"type":"array","x-struct":null,"x-validate":null},{"type":"object","x-struct":null,"x-validate":null}],"x-struct":null,"x-validate":null}},"required":["check_id","name","value"],"title":"Fact","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.Fact","x-validate":null},"FactError":{"description":"An error describing that a fact could not be gathered","properties":{"check_id":{"description":"Check ID","type":"string","x-struct":null,"x-validate":null},"message":{"description":"Error message","type":"string","x-struct":null,"x-validate":null},"name":{"description":"Fact name","type":"string","x-struct":null,"x-validate":null},"type":{"description":"Error type","type":"string","x-struct":null,"x-validate":null}},"required":["check_id","name","type","message"],"title":"FactError","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.FactError","x-validate":null},"Health":{"example":{"database":"pass"},"properties":{"database":{"description":"The status of the database connection","enum":["pass","fail"],"type":"string","x-struct":null,"x-validate":null}},"title":"Health","type":"object","x-struct":"Elixir.WandaWeb.Schemas.Health","x-validate":null},"JsonErrorResponse":{"properties":{"errors":{"items":{"properties":{"detail":{"example":"null value where string expected","type":"string","x-struct":null,"x-validate":null},"source":{"properties":{"pointer":{"example":"/data/attributes/petName","type":"string","x-struct":null,"x-validate":null}},"required":["pointer"],"type":"object","x-struct":null,"x-validate":null},"title":{"example":"Invalid value","type":"string","x-struct":null,"x-validate":null}},"required":["title","source","detail"],"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null}},"required":["errors"],"title":"JsonErrorResponse","type":"object","x-struct":"Elixir.OpenApiSpex.JsonErrorResponse","x-validate":null},"ListExecutionsResponse":{"description":"The paginated list of executions","properties":{"items":{"items":{"$ref":"#/components/schemas/ExecutionResponse"},"type":"array","x-struct":null,"x-validate":null},"total_count":{"description":"Total count of executions","type":"integer","x-struct":null,"x-validate":null}},"title":"ListExecutionsResponse","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ListExecutionsResponse","x-validate":null},"NotFound":{"properties":{"errors":{"items":{"properties":{"detail":{"example":"The requested resource cannot be found.","type":"string","x-struct":null,"x-validate":null},"title":{"example":"Not Found","type":"string","x-struct":null,"x-validate":null}},"type":"object","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null}},"title":"NotFound","type":"object","x-struct":"Elixir.WandaWeb.Schemas.NotFound","x-validate":null},"Ready":{"example":{"ready":true},"properties":{"ready":{"description":"Wanda platform ready","type":"boolean","x-struct":null,"x-validate":null}},"title":"Ready","type":"object","x-struct":"Elixir.WandaWeb.Schemas.Ready","x-validate":null},"StartExecutionRequest":{"description":"Context to run a Check Execution","properties":{"env":{"$ref":"#/components/schemas/ExecutionEnv"},"execution_id":{"description":"Execution identifier","format":"uuid","type":"string","x-struct":null,"x-validate":null},"group_id":{"description":"Group Execution identifier","format":"uuid","type":"string","x-struct":null,"x-validate":null},"target_type":{"description":"Execution target type","type":"string","x-struct":null,"x-validate":null},"targets":{"items":{"$ref":"#/components/schemas/Target"},"title":"Targets","type":"array","x-struct":null,"x-validate":null}},"required":["execution_id","group_id","targets"],"title":"StartExecutionRequest","type":"object","x-struct":"Elixir.WandaWeb.Schemas.V1.StartExecutionRequest","x-validate":null},"Target":{"description":"Target where execution facts are gathered","properties":{"agent_id":{"description":"Agent ID","format":"uuid","type":"string","x-struct":null,"x-validate":null},"checks":{"items":{"description":"Check ID","type":"string","x-struct":null,"x-validate":null},"type":"array","x-struct":null,"x-validate":null}},"required":["agent_id","checks"],"title":"Target","type":"object","x-struct":"Elixir.WandaWeb.Schemas.ExecutionResponse.Target","x-validate":null},"Targets":{"items":{"$ref":"#/components/schemas/Target"},"title":"Targets","type":"array","x-struct":null,"x-validate":null}},"securitySchemes":{"authorization":{"scheme":"bearer","type":"http"}}},"info":{"description":"wanda","title":"Wanda","version":"1.2.0"},"openapi":"3.0.0","paths":{"/api/healthz":{"get":{"callbacks":{},"description":"Get the health status of the Wanda platform","operationId":"WandaWeb.HealthController.health","parameters":[],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Health"}}},"description":"Wanda health status"}},"security":[],"summary":"Wanda health","tags":["Platform"]}},"/api/readyz":{"get":{"callbacks":{},"description":"Check if Wanda is ready","operationId":"WandaWeb.HealthController.ready","parameters":[],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Ready"}}},"description":"Wanda is ready"}},"security":[],"summary":"Wanda ready","tags":["Platform"]}},"/api/v1/checks/catalog":{"get":{"callbacks":{},"operationId":"WandaWeb.V1.CatalogController.catalog","parameters":[{"description":"env variables","explode":true,"in":"query","name":"env","required":false,"schema":{"$ref":"#/components/schemas/ExecutionEnv"},"style":"form"}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CatalogResponse"}}},"description":"Check catalog response"},"422":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonErrorResponse"}}},"description":"Unprocessable Entity"}},"summary":"List checks catalog","tags":[]}},"/api/v1/checks/executions":{"get":{"callbacks":{},"operationId":"WandaWeb.V1.ExecutionController.index","parameters":[{"description":"Filter by group ID","example":"00000000-0000-0000-0000-000000000001","in":"query","name":"group_id","required":false,"schema":{"format":"uuid","type":"string","x-struct":null,"x-validate":null}},{"description":"Page","example":3,"in":"query","name":"page","required":false,"schema":{"type":"integer","x-struct":null,"x-validate":null}},{"description":"Items per page","example":20,"in":"query","name":"items_per_page","required":false,"schema":{"type":"integer","x-struct":null,"x-validate":null}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListExecutionsResponse"}}},"description":"List executions response"},"422":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonErrorResponse"}}},"description":"Unprocessable Entity"}},"summary":"List executions","tags":[]}},"/api/v1/checks/executions/start":{"post":{"callbacks":{},"description":"Start a Checks Execution on the target infrastructure","operationId":"WandaWeb.V1.ExecutionController.start","parameters":[],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StartExecutionRequest"}}},"description":"Execution Context","required":false},"responses":{"202":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AcceptedExecutionResponse"}}},"description":"Accepted Execution Response"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BadRequest"}}},"description":"Bad Request"},"422":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonErrorResponse"}}},"description":"Unprocessable Entity"}},"summary":"Start a Checks Execution","tags":[]}},"/api/v1/checks/executions/{id}":{"get":{"callbacks":{},"operationId":"WandaWeb.V1.ExecutionController.show","parameters":[{"description":"Execution ID","example":"00000000-0000-0000-0000-000000000001","in":"path","name":"id","required":true,"schema":{"format":"uuid","type":"string","x-struct":null,"x-validate":null}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecutionResponse"}}},"description":"Execution"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotFound"}}},"description":"Not Found"},"422":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonErrorResponse"}}},"description":"Unprocessable Entity"}},"summary":"Get an execution by ID","tags":[]}},"/api/v1/checks/groups/{id}/executions/last":{"get":{"callbacks":{},"operationId":"WandaWeb.V1.ExecutionController.last","parameters":[{"description":"Group ID","example":"00000000-0000-0000-0000-000000000001","in":"path","name":"id","required":true,"schema":{"format":"uuid","type":"string","x-struct":null,"x-validate":null}}],"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecutionResponse"}}},"description":"Execution"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotFound"}}},"description":"Not Found"},"422":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonErrorResponse"}}},"description":"Unprocessable Entity"}},"summary":"Get the last execution of a group","tags":[]}}},"security":[{"authorization":[]}],"servers":[{"url":"https://demo.trento-project.io","variables":{}}],"tags":[]}
