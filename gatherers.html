<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.0">
    <meta name="project" content="Wanda v0.1.0">

    <title>Gatherers — Wanda v0.1.0</title>
    <link rel="stylesheet" href="dist/html-elixir-2YOS5DIE.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-X7YVL3G2.js"></script>
    <script src="dist/sidebar_items-627A1975.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-XN2TSG4M.js"></script>


  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="readme.html">
        <img src="assets/logo.svg" alt="Wanda" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="readme.html" class="sidebar-projectName" translate="no">
Wanda
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.1.0
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">GUIDES</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/trento-project/wanda/blob/main/guides/gatherers.md#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span>Gatherers</span>
</h1>

<h2 id="introduction" class="section-heading">
  <a href="#introduction" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">introduction</p>
  </a>
  Introduction
</h2>
<p>Gatherers can be thought of as functions:</p><ul><li>they have a name</li><li>they accept argument(s)</li><li>they return a value, the gathered <a href="specification.html#facts">Fact</a></li></ul><p>Facts Gathering process in a nutshell</p><pre><code class="makeup elixir" translate="no"><span class="n">fact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gatherer</span><span class="p" data-group-id="8710123795-1">(</span><span class="n">argument</span><span class="p" data-group-id="8710123795-1">)</span></code></pre><h2 id="available-gatherers" class="section-heading">
  <a href="#available-gatherers" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">available-gatherers</p>
  </a>
  Available Gatherers
</h2>
<p>Here's a collection of built-in gatherers, with information about how to use them.</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Implementation</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#cibadmin"><code class="inline">cibadmin</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/cibadmin.go">trento-project/agent/../gatherers/cibadmin.go</a></td></tr><tr><td style="text-align: left;"><a href="#corosyncconf"><code class="inline">corosync.conf</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/corosyncconf.go">trento-project/agent/../gatherers/corosyncconf.go</a></td></tr><tr><td style="text-align: left;"><a href="#corosync-cmapctl"><code class="inline">corosync-cmapctl</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/corosynccmapctl.go">trento-project/agent/../gatherers/corosynccmapctl.go</a></td></tr><tr><td style="text-align: left;"><a href="#hosts-etchosts"><code class="inline">hosts</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/hostsfile.go">trento-project/agent/../gatherers/hostsfile.go</a></td></tr><tr><td style="text-align: left;"><a href="#package_version"><code class="inline">package_version</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/packageversion.go">trento-project/agent/../gatherers/packageversion.go</a></td></tr><tr><td style="text-align: left;"><a href="#saphostctrl"><code class="inline">saphostctrl</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/saphostctrl.go">trento-project/agent/../gatherers/saphostctrl.go</a></td></tr><tr><td style="text-align: left;"><a href="#sbd_config"><code class="inline">sbd_config</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sbd.go">trento-project/agent/../gatherers/sbd.go</a></td></tr><tr><td style="text-align: left;"><a href="#sbd_dump"><code class="inline">sbd_dump</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sbddump.go">trento-project/agent/../gatherers/sbddump.go</a></td></tr><tr><td style="text-align: left;"><a href="#systemd"><code class="inline">systemd</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/systemd.go">trento-project/agent/../gatherers/systemd.go</a></td></tr><tr><td style="text-align: left;"><a href="#verify_password"><code class="inline">verify_password</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/verifypassword.go">trento-project/agent/../gatherers/verifypassword.go</a></td></tr></tbody></table><h3 id="cibadmin" class="section-heading">
  <a href="#cibadmin" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">cibadmin</p>
  </a>
  cibadmin
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing Pacemaker's CIB information, the output of the <code class="inline">cibadmin</code> command more precisely.
As the <code class="inline">cibadmin</code> command output is in XML format, the gatherer converts it to map/dictionary type format, so the fields are available with the normal dot access way.
Some specific fields, such as <code class="inline">primitive</code>, <code class="inline">clone</code>, <code class="inline">master</code>, etc (find the complete list <a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/cibadmin.go#L48">here</a>) are converted to lists, in order to avoid differences when the field appears one or multiple times.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">cib.configuration</code></td><td style="text-align: left;">complete cib configuration entry as a map</td></tr><tr><td style="text-align: left;"><code class="inline">cib.configuration.resources.primitive.0</code></td><td style="text-align: left;">first available primitive resource</td></tr><tr><td style="text-align: left;"><code class="inline">cib.configuration.crm_config.cluster_property_set.0.nvpair.1</code></td><td style="text-align: left;">second nvpair value from the first element of cluster_property_set</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: cib_configuration
    gatherer: cibadmin
    argument: cib.configuration

  - name: first_primitive
    gatherer: cibadmin
    argument: cib.configuration.resources.primitive.0

  - name: first_cluster_property_set_second_nvpair
    gatherer: cibadmin
    argument: cib.configuration.crm_config.cluster_property_set.0.nvpair.1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// first_primitive
#{
    class: &quot;stonith&quot;,
    id: &quot;stonith-sbd&quot;,
    instance_attributes: #{
        id: &quot;stonith-sbd-instance_attributes&quot;,
        nvpair: [#{
            id: &quot;stonith-sbd-instance_attributes-pcmk_delay_max&quot;,
            name: &quot;pcmk_delay_max&quot;,
            value: &quot;30s&quot;
        }]
    },
    type: &quot;external/sbd&quot;
};

// first_cluster_property_set_second_nvpair
#{
    id: &quot;cib-bootstrap-options-dc-version&quot;,
    name: &quot;dc-version&quot;,
    value: &quot;2.0.4+20200616.2deceaa3a-3.12.1-2.0.4+20200616.2deceaa3a&quot;
};</code></pre><h3 id="corosync-conf" class="section-heading">
  <a href="#corosync-conf" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">corosync-conf</p>
  </a>
  corosync.conf
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing the information contained in <code class="inline">/etc/corosync/corosync.conf</code></p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">totem.token</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">totem.join</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node.&lt;node_index&gt;.nodeid</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node</code></td><td style="text-align: left;">list of objects representing the nodes</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: corosync_token_timeout
    gatherer: corosync.conf
    argument: totem.token

  - name: corosync_join
    gatherer: corosync.conf
    argument: totem.join

  - name: corosync_node_id_0
    gatherer: corosync.conf
    argument: nodelist.node.0.nodeid

  - name: corosync_node_id_1
    gatherer: corosync.conf
    argument: nodelist.node.1.nodeid

  - name: corosync_nodes
    gatherer: corosync.conf
    argument: nodelist.node</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// corosync_token_timeout
30000;

// corosync_join
60;

// corosync_node_id_0
1;

// corosync_node_id_1
2;

// corosync_nodes
[#{nodeid: 1, ring0_addr: &quot;192.168.157.10&quot;}, #{nodeid: 2, ring0_addr: &quot;192.168.157.11&quot;}];</code></pre><p>For extra information refer to <a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/corosyncconf_test.go">trento-project/agent/../gatherers/corosyncconf_test.go</a></p><h3 id="corosync-cmapctl" class="section-heading">
  <a href="#corosync-cmapctl" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">corosync-cmapctl</p>
  </a>
  corosync-cmapctl
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows accessing the output of the <code class="inline">corosync-cmapctl</code> tool. It supports all of the keys returned by it to be queried.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">totem.token</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">runtime.config.totem.token</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">totem.transport</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">runtime.config.totem.max_messages</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node.0.ring0_addr</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node.1</code></td><td style="text-align: left;">extracted value from the command</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: totem_token
    gatherer: corosync-cmapctl
    argument: totem.token

  - name: runtime_totem_token
    gatherer: corosync-cmapctl
    argument: runtime.config.totem.token

  - name: totem_transport
    gatherer: corosync-cmapctl
    argument: totem.transport

  - name: totem_max_messages
    gatherer: corosync-cmapctl
    argument: runtime.config.totem.max_messages

  - name: node_0_ring0addr
    gatherer: corosync-cmapctl
    argument: nodelist.node.0.ring0_addr

  - name: node_list
    gatherer: corosync-cmapctl
    argument: nodelist.node

  - name: second_node
    gatherer: corosync-cmapctl
    argument: nodelist.node.1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// totem_token
30000;

// runtime_totem_token
30000;

// totem_transport
&quot;udpu&quot;;

// totem_max_messages
20;

// node_0_ring0addr
&quot;10.80.1.11&quot;;

// node_list
#{
  &quot;0&quot;: #{
    nodeid: 1,
    ring0_addr: &quot;10.80.1.11&quot;
  },
  &quot;1&quot;: #{
    nodeid: 2,
    ring0_addr: &quot;10.80.1.12&quot;
  }
};

// second_node
#{ nodeid: 2, ring0_addr: &quot;10.80.1.12&quot; };</code></pre><h3 id="hosts-etc-hosts" class="section-heading">
  <a href="#hosts-etc-hosts" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">hosts-etc-hosts</p>
  </a>
  hosts (/etc/hosts)
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing the hostnames that are resolvable through <code class="inline">/etc/hosts</code>. It
does <strong>not</strong> use domain resolution in any way but instead directly parses the file.</p><p>It allows one argument to be specified or none at all:</p><ul><li>When a hostname is provided as an argument, the gatherer will return an array of IPv4 and/or IPv6 addresses.</li><li>When no argument is provided, the gatherer will return a map with hostname as keys and arrays with IPv4 and/or IPv6 addresses.</li></ul><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">localhost</code></td><td style="text-align: left;">list of IPs resolving</td></tr><tr><td style="text-align: left;"><code class="inline">node1</code></td><td style="text-align: left;">list of IPs resolving</td></tr><tr><td style="text-align: left;"><code class="inline">no argument provided</code></td><td style="text-align: left;">map with hostnames and IP addresses</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: hosts_node1
    gatherer: hosts
    argument: node1

  - name: hosts_node2
    gatherer: hosts
    argument: node2

  - name: hosts_all
    gatherer: hosts</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// hosts_node1
[&quot;127.0.0.1&quot;, &quot;::1&quot;];

// hosts_node2
[&quot;192.168.157.11&quot;];

// hosts_all
#{
  &quot;localhost&quot;: [&quot;127.0.0.1&quot;, &quot;::1&quot;],
  &quot;node1&quot;: [&quot;192.168.157.10&quot;],
  &quot;node2&quot;: [&quot;192.168.157.11&quot;],
  ...
};</code></pre><h3 id="package_version" class="section-heading">
  <a href="#package_version" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">package_version</p>
  </a>
  package_version
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer supports two usecases:</p><ul><li>get the version as a string of the specified package (useful to check if the installed version of a package is the same across multiple nodes)</li><li>compare a given version string against the installed version string of a given package.</li></ul><p>While for the first usecase, a simple string containing the version is returned, for the second usecase, the return value is as follows (see additional details <a href="https://fedoraproject.org/wiki/Archive:Tools/RPM/VersionComparison#The_rpmvercmp_algorithm">here</a>):</p><ul><li>A value of <code class="inline">0</code> if the provided version string matches the installed package version for the requested package.</li><li>A value of <code class="inline">-1</code> if the provided version string is older that what's currently installed.</li><li>A value of <code class="inline">1</code> if the provided version string is newer than what's currently installed.</li></ul><p>Naming the facts / expectations accordingly is specially important here to avoid confusion.</p><ul><li>We suggest using a <code class="inline">compare_</code> prefix for package version comparisons and <code class="inline">package_</code> to retrieve
a package version</li></ul><p>Additionally, when using the version comparison, it increases readability to explicitly mention
the values to compare against:</p><pre><code class="yaml">facts:
  - name: compare_package_corosync
    gatherer: package_version
    argument: corosync,2.4.5

values:
  - name: greater_than_installed
    default: 1
  - name: lesser_than_installed
    default: -1
  - name: same_as_installed
    default: 0

expectations:
  - name: compare_package_corosync
    expect: facts.compare_package_corosync == values.greater_than_installed</code></pre><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">package_name</code></td><td style="text-align: left;">a string containing the installed version of the rpm package</td></tr><tr><td style="text-align: left;"><code class="inline">package_name,2.4.5</code></td><td style="text-align: left;">an integer with a value of <code class="inline">-1</code>, <code class="inline">0</code> or <code class="inline">-1</code> (see above)</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: package_corosync
    gatherer: package_version
    argument: corosync

  - name: package_pacemaker
    gatherer: package_version
    argument: pacemaker

  - name: compare_package_corosync
    gatherer: package_version
    argument: corosync,2.4.5

  ...</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// package_corosync
&quot;2.4.5&quot;;

// package_pacemaker
&quot;2.0.4+20200616.2deceaa3a&quot;;

// compare_package_corosync
0</code></pre><h3 id="saphostctrl" class="section-heading">
  <a href="#saphostctrl" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">saphostctrl</p>
  </a>
  saphostctrl
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows access to certain webmethods that <code class="inline">saphostctrl</code> implements. An argument is required to specify
which webmethod should be called. This webmethod is passed to the <code class="inline">saphostctrl</code> command-line tool through the <code class="inline">-function</code> argument.</p><p>Supported webmethods:</p><ul><li><code class="inline">Ping</code></li><li><code class="inline">ListInstances</code></li></ul><p>A <code class="inline">Ping</code> call with a successful return should look like this:</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: ping
    gatherer: saphostctrl
    argument: Ping

  - name: list_instances
    gatherer: saphostctrl
    argument: ListInstances</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// ping
#{elapsed: 579770.0, status: &quot;SUCCESS&quot;}

// list_instances
[
    #{
        &quot;changelist&quot;: 1908545,
        &quot;hostname&quot;: &quot;vmhana01&quot;,
        &quot;instance&quot;: &quot;00&quot;,
        &quot;patch&quot;: 410,
        &quot;sapkernel&quot;: 753,
        &quot;system&quot;: &quot;PRD&quot;
    }
];</code></pre><h3 id="sbd_config" class="section-heading">
  <a href="#sbd_config" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">sbd_config</p>
  </a>
  sbd_config
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows accessing the information contained in <code class="inline">/etc/sysconfig/sbd</code></p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">SBD_PACEMAKER</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">SBD_STARTMODE</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">SBD_DEVICE</code></td><td style="text-align: left;">extracted value from the config</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: sbd_pacemaker
    gatherer: sbd_config
    argument: SBD_PACEMAKER

  - name: sbd_startmode
    gatherer: sbd_config
    argument: SBD_STARTMODE

  - name: sbd_device
    gatherer: sbd_config
    argument: SBD_DEVICE</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// sbd_pacemaker
&quot;yes&quot;;

// sbd_startmode
&quot;always&quot;;

// sbd_device
&quot;/dev/vdc;/dev/vdb&quot;;</code></pre><h3 id="sbd_dump" class="section-heading">
  <a href="#sbd_dump" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">sbd_dump</p>
  </a>
  sbd_dump
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing the sbd dump command output data.</p><p>It executes the <code class="inline">sbd -d &lt;device&gt; dump</code> command in all devices configured in the <code class="inline">SBD_DEVICE</code> field on <code class="inline">/etc/sysconfig/sbd</code> and aggregates results in only one fact.</p><p>Note that:</p><ul><li>no arguments are required</li><li>if any of the dumps fail, a fact error is returned</li></ul><p>Dumped keys (<code class="inline">Timeout (watchdog)</code>, <code class="inline">Timeout (msgwait)</code>, <code class="inline">Number of slots</code>, etc) are sanitized to simplify their access and usage in the expression language.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: sbd_devices_dump
    gatherer: sbd_dump</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// sbd_devices_dump
#{
    &quot;/dev/vdc&quot;: #{
        header_version: 2.1,
        number_of_slots: 255,
        sector_size: 512,
        timeout_allocate: 2,
        timeout_loop: 1,
        timeout_msgwait: 10,
        timeout_watchdog: 5,
        uuid: &quot;69048391-c647-4b34-a03a-f704f5cc2258&quot;
    }
};</code></pre><p>For extra information refer to <a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sbddump_test.go">trento-project/agent/../gatherers/sbddump_test.go</a></p><h3 id="systemd" class="section-heading">
  <a href="#systemd" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">systemd</p>
  </a>
  systemd
</h3>
<p><strong>Argument required</strong>: yes.</p><p>Gather systemd units state. It returns an <code class="inline">active/inactive</code> string.
If the service is disabled or it does not exist, <code class="inline">inactive</code> is returned.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">trento-agent</code></td><td style="text-align: left;">state of the systemd unit</td></tr></tbody></table><pre><code class="yaml">facts:
  - name: sbd_state
    gatherer: systemd
    argument: sbd

  - name: corosync_state
    gatherer: systemd
    argument: corosync</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// sbd_state
&quot;active&quot;;

// corosync_state
&quot;inactive&quot;;</code></pre><h3 id="verify_password" class="section-heading">
  <a href="#verify_password" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">verify_password</p>
  </a>
  verify_password
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer determines whether a given user has its password still set to an unsafe password.
It returns <code class="inline">true</code> if the password matches a password in the list of unsafe passwords, <code class="inline">false</code> otherwise.</p><p>Specification examples:</p><pre><code class="yaml">facts:
  - name: hacluster_has_default_password
    gatherer: verify_password
    argument: hacluster</code></pre><p>For the argument, only whitelisted users are allowed. Currently whitelisted usernames:</p><ul><li><code class="inline">hacluster</code></li></ul><p>List of unsafe passwords:</p><ul><li><code class="inline">linux</code></li></ul><p>Example output (in Rhai):</p><pre><code class="ts">// hacluster_has_default_password
true;</code></pre>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="expression_language.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Expression Language
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

  </div>
</div>
      <footer class="footer">

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.0) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
