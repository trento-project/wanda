<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.37.1">
    <meta name="project" content="Wanda v1.4.0">


    <title>Gatherers â€” Wanda v1.4.0</title>

    <link rel="stylesheet" href="dist/html-elixir-6X3L5KMG.css" />

    <script defer src="dist/sidebar_items-2A726CA3.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-6XHBGSGW.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="readme.html" class="sidebar-projectImage">
          <img src="assets/logo.svg" alt="Wanda" />
        </a>

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
Wanda
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.4.0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras="GUIDES"></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Wanda</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Gatherers</h1>


      <a href="https://github.com/trento-project/wanda/blob/main/guides/gatherers.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>

<h2 id="introduction" class="section-heading">
  <a href="#introduction" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Introduction</span>
</h2>
<p>Gatherers can be thought of as functions:</p><ul><li>they have a name</li><li>they accept argument(s)</li><li>they return a value, the gathered <a href="specification.html#facts">Fact</a></li></ul><p>Facts Gathering process in a nutshell</p><pre><code class="makeup elixir" translate="no"><span class="n">fact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gatherer</span><span class="p" data-group-id="3727996490-1">(</span><span class="n">argument</span><span class="p" data-group-id="3727996490-1">)</span></code></pre><h2 id="gatherers-versioning" class="section-heading">
  <a href="#gatherers-versioning" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Gatherers versioning</span>
</h2>
<p>The gatherers implementation supports a versioning mechanism in order to enable non-backwards compatibility changes in any of them. When an update to
the trento-agent includes a non-backwards compatible change in a gatherer (e.g., changes to the Rhai output format), its version is
bumped by incrementing the @vN suffix that follows the gatherer's name, where 'N' represents the new version of that gatherer.
Example:</p><ul><li><code class="inline">systemd@v1</code> -&gt; Represents the first version of the systemd gatherer</li><li><code class="inline">systemd@v2</code> -&gt; Represents the second version of the systemd gatherer</li></ul><p>Note that when writing a check, if no tag is specified (e.g. <code class="inline">systemd</code>), the latest version is used. It is <strong>strongly</strong> recommended to always pin your
checks to a specific version of a gatherer.</p><p>Not all changes in a released gatherer get a new version tag. A new version tag is released only for breaking changes, while non-breaking changes such
as additional fields in the Rhai output reuse the latest existing tag. To use a check that relies on a newer field introduced after an update, upgrade
the agent to the latest version to ensure that the required gatherers are also up-to-date.</p><h2 id="available-gatherers" class="section-heading">
  <a href="#available-gatherers" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Available Gatherers</span>
</h2>
<p>Here's a collection of built-in gatherers, with information about how to use them.</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Implementation</th></tr></thead><tbody><tr><td style="text-align: left;"><a href="#ascsers_clusterv1"><code class="inline">ascsers_cluster@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/ascsers_cluster.go">trento-project/agent/../gatherers/ascsers_cluster.go</a></td></tr><tr><td style="text-align: left;"><a href="#cibadminv1"><code class="inline">cibadmin@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/cibadmin.go">trento-project/agent/../gatherers/cibadmin.go</a></td></tr><tr><td style="text-align: left;"><a href="#corosyncconfv1"><code class="inline">corosync.conf@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/corosyncconf.go">trento-project/agent/../gatherers/corosyncconf.go</a></td></tr><tr><td style="text-align: left;"><a href="#corosync-cmapctlv1"><code class="inline">corosync-cmapctl@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/corosynccmapctl.go">trento-project/agent/../gatherers/corosynccmapctl.go</a></td></tr><tr><td style="text-align: left;"><a href="#dir_scanv1"><code class="inline">dir_scan@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/dir_scan.go">trento-project/agent/../gatherers/dir_scan.go</a></td></tr><tr><td style="text-align: left;"><a href="#dispworkv1"><code class="inline">disp+work@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/dispwork.go">trento-project/agent/../gatherers/dispwork.go</a></td></tr><tr><td style="text-align: left;"><a href="#fstabv1"><code class="inline">fstab@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/fstab.go">trento-project/agent/../gatherers/fstab.go</a></td></tr><tr><td style="text-align: left;"><a href="#groupsv1"><code class="inline">groups@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/groups.go">trento-project/agent/../gatherers/groups.go</a></td></tr><tr><td style="text-align: left;"><a href="#hostsv1"><code class="inline">hosts@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/hostsfile.go">trento-project/agent/../gatherers/hostsfile.go</a></td></tr><tr><td style="text-align: left;"><a href="#mount_infov1"><code class="inline">mount_info@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/mountinfo.go">trento-project/agent/../gatherers/mountinfo.go</a></td></tr><tr><td style="text-align: left;"><a href="#os-releasev1"><code class="inline">os-release@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/osrelease.go">trento-project/agent/../gatherers/osrelease.go</a></td></tr><tr><td style="text-align: left;"><a href="#package_versionv1"><code class="inline">package_version@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/packageversion.go">trento-project/agent/../gatherers/packageversion.go</a></td></tr><tr><td style="text-align: left;"><a href="#passwdv1"><code class="inline">passwd@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/passwd.go">trento-project/agent/../gatherers/passwd.go</a></td></tr><tr><td style="text-align: left;"><a href="#productsv1"><code class="inline">products@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/products.go">trento-project/agent/../gatherers/products.go</a></td></tr><tr><td style="text-align: left;"><a href="#sapcontrolv1"><code class="inline">sapcontrol@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sapcontrol.go">trento-project/agent/../gatherers/sapcontrol.go</a></td></tr><tr><td style="text-align: left;"><a href="#saphostctrlv1"><code class="inline">saphostctrl@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/saphostctrl.go">trento-project/agent/../gatherers/saphostctrl.go</a></td></tr><tr><td style="text-align: left;"><a href="#sap_profilesv1"><code class="inline">sap_profiles@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sapprofiles.go">trento-project/agent/../gatherers/sapprofiles.go</a></td></tr><tr><td style="text-align: left;"><a href="#sapinstance_hostname_resolverv1"><code class="inline">sapinstance_hostname_resolver@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sapinstancehostnameresolver.go">trento-project/agent/../gatherers/sapinstancehostnameresolver.go</a></td></tr><tr><td style="text-align: left;"><a href="#sapservicesv1"><code class="inline">sapservices@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sapservices.go">trento-project/agent/../gatherers/sapservices.go</a></td></tr><tr><td style="text-align: left;"><a href="#saptunev1"><code class="inline">saptune@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/saptune.go">trento-project/agent/../gatherers/saptune.go</a></td></tr><tr><td style="text-align: left;"><a href="#sbd_configv1"><code class="inline">sbd_config@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sbd.go">trento-project/agent/../gatherers/sbd.go</a></td></tr><tr><td style="text-align: left;"><a href="#sbd_dumpv1"><code class="inline">sbd_dump@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sbddump.go">trento-project/agent/../gatherers/sbddump.go</a></td></tr><tr><td style="text-align: left;"><a href="#sysctlv1"><code class="inline">sysctl@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sysctl.go">trento-project/agent/../gatherers/sysctl.go</a></td></tr><tr><td style="text-align: left;"><a href="#systemdv1"><code class="inline">systemd@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/systemd.go">trento-project/agent/../gatherers/systemd.go</a></td></tr><tr><td style="text-align: left;"><a href="#systemdv2"><code class="inline">systemd@v2</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/systemd_v2.go">trento-project/agent/../gatherers/systemd_v2.go</a></td></tr><tr><td style="text-align: left;"><a href="#verify_passwordv1"><code class="inline">verify_password@v1</code></a></td><td style="text-align: left;"><a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/verifypassword.go">trento-project/agent/../gatherers/verifypassword.go</a></td></tr></tbody></table><span id="ascsers_clusterv1"></span><h3 id="ascsers_cluster-v1" class="section-heading">
  <a href="#ascsers_cluster-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">ascsers_cluster@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing ASCS/ERS clusters managed systems most relevant information, such as the ensa version and the installed instances.
It is really useful to check multi SID environments.
It doesn't replace the need to use the <code class="inline">cibadmin</code> gatherer, as this gatherer aims to facilitate complex data manipulations using data from that gatherer.
The ensa version is obtained running the <code class="inline">GetProcessList</code> sapcontrol webcommand and parsing the <code class="inline">name</code> output in each of the installed instances.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: ascsers
    gatherer: ascsers_cluster@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">#{
    &quot;PRD&quot;: #{
      &quot;ensa_version&quot;: &quot;ensa1&quot;, // available values: ensa1/ensa2/unknown
      &quot;instances&quot;: [
        #{
          &quot;resource_group&quot;: &quot;grp_PRD_ASCS00&quot;,
          &quot;resource_instance&quot;: &quot;rsc_sap_PRD_ASCS00&quot;,
          &quot;name&quot;: &quot;ASCS00&quot;,
          &quot;instance_number&quot;: &quot;00&quot;,
          &quot;virtual_hostname&quot;: &quot;sapascs00&quot;,
          &quot;filesystem_based&quot;: true, // if the instance resource group has a FileSystem resource
          &quot;local&quot;: true // if the instance is running locally in this host (sapcontrol returns a positive response for GetProcessList)
        },
        #{
          &quot;resource_group&quot;: &quot;grp_PRD_ERS10&quot;,
          &quot;resource_instance&quot;: &quot;rsc_sap_PRD_ERS10&quot;,
          &quot;name&quot;: &quot;ERS10&quot;,
          ...
        }
      ]
    },
    &quot;QAS&quot;: #{
      &quot;ensa_version&quot;: &quot;ensa2&quot;,
      ...
    }
};</code></pre><span id="cibadminv1"></span><h3 id="cibadmin-v1" class="section-heading">
  <a href="#cibadmin-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">cibadmin@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing Pacemaker's CIB information, the output of the <code class="inline">cibadmin</code> command more precisely.
As the <code class="inline">cibadmin</code> command output is in XML format, the gatherer converts it to map/dictionary type format, so the fields are available with the normal dot access way.
Some specific fields, such as <code class="inline">primitive</code>, <code class="inline">clone</code>, <code class="inline">master</code>, etc (find the complete list <a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/cibadmin.go#L48">here</a>) are converted to lists, in order to avoid differences when the field appears one or multiple times.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">cib.configuration</code></td><td style="text-align: left;">complete cib configuration entry as a map</td></tr><tr><td style="text-align: left;"><code class="inline">cib.configuration.resources.primitive.0</code></td><td style="text-align: left;">first available primitive resource</td></tr><tr><td style="text-align: left;"><code class="inline">cib.configuration.crm_config.cluster_property_set.0.nvpair.1</code></td><td style="text-align: left;">second nvpair value from the first element of cluster_property_set</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: cib_configuration
    gatherer: cibadmin@v1
    argument: cib.configuration

  - name: first_primitive
    gatherer: cibadmin@v1
    argument: cib.configuration.resources.primitive.0

  - name: first_cluster_property_set_second_nvpair
    gatherer: cibadmin@v1
    argument: cib.configuration.crm_config.cluster_property_set.0.nvpair.1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// first_primitive
#{
    class: &quot;stonith&quot;,
    id: &quot;stonith-sbd&quot;,
    instance_attributes: #{
        id: &quot;stonith-sbd-instance_attributes&quot;,
        nvpair: [#{
            id: &quot;stonith-sbd-instance_attributes-pcmk_delay_max&quot;,
            name: &quot;pcmk_delay_max&quot;,
            value: &quot;30s&quot;
        }]
    },
    type: &quot;external/sbd&quot;
};

// first_cluster_property_set_second_nvpair
#{
    id: &quot;cib-bootstrap-options-dc-version&quot;,
    name: &quot;dc-version&quot;,
    value: &quot;2.0.4+20200616.2deceaa3a-3.12.1-2.0.4+20200616.2deceaa3a&quot;
};</code></pre><span id="corosyncconfv1"></span><h3 id="corosync-conf-v1" class="section-heading">
  <a href="#corosync-conf-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">corosync.conf@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing the information contained in <code class="inline">/etc/corosync/corosync.conf</code></p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">totem.token</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">totem.join</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node.&lt;node_index&gt;.nodeid</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node</code></td><td style="text-align: left;">list of objects representing the nodes</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: corosync_token_timeout
    gatherer: corosync.conf@v1
    argument: totem.token

  - name: corosync_join
    gatherer: corosync.conf@v1
    argument: totem.join

  - name: corosync_node_id_0
    gatherer: corosync.conf@v1
    argument: nodelist.node.0.nodeid

  - name: corosync_node_id_1
    gatherer: corosync.conf@v1
    argument: nodelist.node.1.nodeid

  - name: corosync_nodes
    gatherer: corosync.conf@v1
    argument: nodelist.node</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// corosync_token_timeout
30000;

// corosync_join
60;

// corosync_node_id_0
1;

// corosync_node_id_1
2;

// corosync_nodes
[#{nodeid: 1, ring0_addr: &quot;192.168.157.10&quot;}, #{nodeid: 2, ring0_addr: &quot;192.168.157.11&quot;}];</code></pre><p>For extra information refer to <a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/corosyncconf_test.go">trento-project/agent/../gatherers/corosyncconf_test.go</a></p><span id="corosync-cmapctlv1"></span><h3 id="corosync-cmapctl-v1" class="section-heading">
  <a href="#corosync-cmapctl-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">corosync-cmapctl@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows accessing the output of the <code class="inline">corosync-cmapctl</code> tool. It supports all of the keys returned by it to be queried.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">totem.token</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">runtime.config.totem.token</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">totem.transport</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">runtime.config.totem.max_messages</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node.0.ring0_addr</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node</code></td><td style="text-align: left;">extracted value from the command</td></tr><tr><td style="text-align: left;"><code class="inline">nodelist.node.1</code></td><td style="text-align: left;">extracted value from the command</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: totem_token
    gatherer: corosync-cmapctl@v1
    argument: totem.token

  - name: runtime_totem_token
    gatherer: corosync-cmapctl@v1
    argument: runtime.config.totem.token

  - name: totem_transport
    gatherer: corosync-cmapctl@v1
    argument: totem.transport

  - name: totem_max_messages
    gatherer: corosync-cmapctl@v1
    argument: runtime.config.totem.max_messages

  - name: node_0_ring0addr
    gatherer: corosync-cmapctl@v1
    argument: nodelist.node.0.ring0_addr

  - name: node_list
    gatherer: corosync-cmapctl@v1
    argument: nodelist.node

  - name: second_node
    gatherer: corosync-cmapctl@v1
    argument: nodelist.node.1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// totem_token
30000;

// runtime_totem_token
30000;

// totem_transport
&quot;udpu&quot;;

// totem_max_messages
20;

// node_0_ring0addr
&quot;10.80.1.11&quot;;

// node_list
#{
  &quot;0&quot;: #{
    nodeid: 1,
    ring0_addr: &quot;10.80.1.11&quot;
  },
  &quot;1&quot;: #{
    nodeid: 2,
    ring0_addr: &quot;10.80.1.12&quot;
  }
};

// second_node
#{ nodeid: 2, ring0_addr: &quot;10.80.1.12&quot; };</code></pre><span id="dir_scanv1"></span><h3 id="dir_scan-v1" class="section-heading">
  <a href="#dir_scan-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">dir_scan@v1</span>
</h3>
<p><strong>Argument required</strong>: Yes</p><p>This gatherer allows to scan directories with a glob pattern provided as argument.
The gatherer returns a list of files matched by the pattern with group/user information associated to each file.</p><p>Example argument:</p><ul><li><code class="inline">/usr/sap/[A-Z][A-Z0-9][A-Z0-9]/ERS[0-9][0-9]</code></li><li><code class="inline">/etc/polkit-1/rules.d/[0-9][0-9]-SAP[A-Z][A-Z0-9][A-Z0-9]-[0-9][0-9].rules</code></li></ul><p>Example specification:</p><pre><code class="yaml">facts:
  - name: dir_scan
    gatherer: dir_scan@v1
    argument: &quot;/usr/sap/[A-Z][A-Z0-9][A-Z0-9]/ERS[0-9][0-9]&quot;</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">  [
    #{
      &quot;name&quot;: &quot;/usr/sap/PRD/ERS01&quot;,
      &quot;owner&quot;: &quot;trento&quot;,
      &quot;group&quot;: &quot;trento&quot;
    },
     #{
      &quot;name&quot;: &quot;/usr/sap/QAS/ERS02&quot;,
      &quot;owner&quot;: &quot;trento&quot;,
      &quot;group&quot;: &quot;trento&quot;
    },
  ]</code></pre><span id="dispworkv1"></span><h3 id="disp-work-v1" class="section-heading">
  <a href="#disp-work-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">disp+work@v1</span>
</h3>
<p><strong>Argument required</strong>: No</p><p>This gatherer allows access to the <code class="inline">disp+work</code> command output and returns some fields available there.
The command is executed for all installed SAP systems, accessing it with the <code class="inline">&lt;sid&gt;adm</code> user. The fields for
each system are returned in a map using the SAP sid as key.</p><p>If the <code class="inline">disp+work</code> command execution fails, the fields are returned with an empty string value.</p><p>The available fields are <code class="inline">compilation_mode</code>, <code class="inline">kernel_release</code> and <code class="inline">patch_number</code>.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: dispwork
    gatherer: disp+work@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">#{
  &quot;NWP&quot;: #{
    &quot;compilation_mode&quot;: &quot;UNICODE&quot;,
    &quot;kernel_release&quot;: &quot;753&quot;,
    &quot;patch_number&quot;: &quot;900&quot;
  },
  // failed execution
  &quot;NWQ&quot;: #{
    &quot;compilation_mode&quot;: &quot;&quot;,
    &quot;kernel_release&quot;: &quot;&quot;,
    &quot;patch_number&quot;: &quot;&quot;
  },
  &quot;NWD&quot;: #{
    &quot;compilation_mode&quot;: &quot;UNICODE&quot;,
    &quot;kernel_release&quot;: &quot;753&quot;,
    &quot;patch_number&quot;: &quot;910&quot;
  }
}</code></pre><span id="fstabv1"></span><h3 id="fstab-v1" class="section-heading">
  <a href="#fstab-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">fstab@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the /etc/fstab file, returning all entries available at the file.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: fstab
    gatherer: fstab@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">[
    #{
        &quot;device&quot;: &quot;/dev/system/root&quot;,
        &quot;mount_point&quot;: &quot;/&quot;,
        &quot;file_system_type&quot;: &quot;btrfs&quot;,
        &quot;options&quot;: [],
        &quot;backup&quot;: 0,
        &quot;check_order&quot;: 1,
    },
    #{
        &quot;device&quot;: &quot;/dev/system/root&quot;,
        &quot;mount_point&quot;: &quot;/home&quot;,
        &quot;file_system_type&quot;: &quot;ext4&quot;,
        &quot;options&quot;: [&quot;defaults&quot;],
        &quot;backup&quot;: 0,
        &quot;check_order&quot;: 1,
    },
  ...
];</code></pre><span id="groupsv1"></span><h3 id="groups-v1" class="section-heading">
  <a href="#groups-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">groups@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the /etc/group file, returning all entries available at the file.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: groups
    gatherer: groups@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">[
    #{
        &quot;name&quot;: &quot;root&quot;,
        &quot;gid&quot;: 0,
        &quot;users&quot;: [],
    },
    #{
        &quot;name&quot;: &quot;adm&quot;,
        &quot;gid&quot;: 1,
        &quot;users&quot;: [&quot;trento&quot;],
    }
  ...
];</code></pre><span id="hostsv1"></span><h3 id="hosts-v1" class="section-heading">
  <a href="#hosts-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">hosts@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing the hostnames that are resolvable through <code class="inline">/etc/hosts</code>. It
does <strong>not</strong> use domain resolution in any way but instead directly parses the file.</p><p>It allows one argument to be specified or none at all:</p><ul><li>When a hostname is provided as an argument, the gatherer will return an array of IPv4 and/or IPv6 addresses.</li><li>When no argument is provided, the gatherer will return a map with hostname as keys and arrays with IPv4 and/or IPv6 addresses.</li></ul><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">localhost</code></td><td style="text-align: left;">list of IPs resolving</td></tr><tr><td style="text-align: left;"><code class="inline">node1</code></td><td style="text-align: left;">list of IPs resolving</td></tr><tr><td style="text-align: left;"><code class="inline">no argument provided</code></td><td style="text-align: left;">map with hostnames and IP addresses</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: hosts_node1
    gatherer: hosts@v1
    argument: node1

  - name: hosts_node2
    gatherer: hosts@v1
    argument: node2

  - name: hosts_all
    gatherer: hosts@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// hosts_node1
[&quot;127.0.0.1&quot;, &quot;::1&quot;];

// hosts_node2
[&quot;192.168.157.11&quot;];

// hosts_all
#{
  &quot;localhost&quot;: [&quot;127.0.0.1&quot;, &quot;::1&quot;],
  &quot;node1&quot;: [&quot;192.168.157.10&quot;],
  &quot;node2&quot;: [&quot;192.168.157.11&quot;],
  ...
};</code></pre><span id="mount_infov1"></span><h3 id="mount_info-v1" class="section-heading">
  <a href="#mount_info-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">mount_info@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows accessing the OS file system mount points. It returns information about the mount point of a given path.
Besides of the mount information, if the mount is done in a local block device, it returns the UUID of the block (coming from the <code class="inline">blkid</code> command).
If the given path is not mounted, all the fields are returned with empty strings.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: not_mounted
    gatherer: mount_info@v1
    argument: /usr/sap

  - name: shared_nfs
    gatherer: mount_info@v1
    argument: /sapmnt

  - name: mounted_locally
    gatherer: mount_info@v1
    argument: /hana/data</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// not_mounted
#{
  &quot;block_uuid&quot;: &quot;&quot;,
  &quot;fs_type&quot;: &quot;&quot;,
  &quot;mount_point&quot;: &quot;&quot;,
  &quot;options&quot;: &quot;&quot;,
  &quot;source&quot;: &quot;&quot;
}

// shared_nfs
#{
  &quot;block_uuid&quot;: &quot;&quot;,
  &quot;fs_type&quot;: &quot;nfs4&quot;,
  &quot;mount_point&quot;: &quot;/sapmnt&quot;,
  &quot;options&quot;: &quot;rw,relatime&quot;,
  &quot;source&quot;: &quot;10.1.1.10://sapmnt&quot;
}

// mounted_locally
#{
  &quot;block_uuid&quot;: &quot;f45cf408-efgh-abcd-88ec-2f9269a12f07&quot;,
  &quot;fs_type&quot;: &quot;xfs&quot;,
  &quot;mount_point&quot;: &quot;/hana/data&quot;,
  &quot;options&quot;: &quot;rw,relatime&quot;,
  &quot;source&quot;: &quot;/dev/mapper/vg_hana-lv_hana_data&quot;
}</code></pre><span id="os-releasev1"></span><h3 id="os-release-v1" class="section-heading">
  <a href="#os-release-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">os-release@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the distribution details in <code class="inline">/etc/os-release</code>. This file contains operating system identification data, such as the
vendor of the distribution, the name of the distribution, the version and the ID of the distribution, as well as many other details.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: os_release
    gatherer: os-release@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// output from openSUSE Leap 15.2
#{
  &quot;ANSI_COLOR&quot;: &quot;0;32&quot;,
  &quot;BUG_REPORT_URL&quot;: &quot;https://bugs.opensuse.org&quot;,
  &quot;CPE_NAME&quot;: &quot;cpe:/o:opensuse:leap:15.2&quot;,
  &quot;HOME_URL&quot;: &quot;https://www.opensuse.org/&quot;,
  &quot;ID&quot;: &quot;opensuse-leap&quot;,
  &quot;ID_LIKE&quot;: &quot;suse opensuse&quot;,
  &quot;NAME&quot;: &quot;openSUSE Leap&quot;,
  &quot;PRETTY_NAME&quot;: &quot;openSUSE Leap 15.2&quot;,
  &quot;VERSION&quot;: &quot;15.2&quot;,
  &quot;VERSION_ID&quot;: &quot;15.2&quot;
}</code></pre><span id="package_versionv1"></span><h3 id="package_version-v1" class="section-heading">
  <a href="#package_version-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">package_version@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer supports two usecases:</p><ul><li>get information about the installed versions of the specified package.</li><li>compare a given version string against the latest installed version of a given package.</li></ul><p>In the first usecase a list of objects is returned, where each object carries relevant information about an installed version of a package.</p><blockquote><p>Note:</p><ul><li>a list of one element is often expected since usually the installed version would be only one</li><li>detected installed versions list is ordered by descending installation time: <strong>latest installed versions come first</strong></li><li>operating on the latest installed version requires accessing the first element in the list via <code class="inline">package_fact_name[0]</code> or <code class="inline">package_fact_name.first()</code></li></ul></blockquote><p>In the second usecase, the return value is as follows (see additional details <a href="https://fedoraproject.org/wiki/Archive:Tools/RPM/VersionComparison#The_rpmvercmp_algorithm">here</a>):</p><ul><li>A value of <code class="inline">0</code> if the provided version string matches the installed package version for the requested package.</li><li>A value of <code class="inline">-1</code> if the provided version string is older that what's currently installed.</li><li>A value of <code class="inline">1</code> if the provided version string is newer than what's currently installed.</li></ul><blockquote><p>The latest detected installed version is used for comparison</p></blockquote><p>Naming the facts / expectations accordingly is specially important here to avoid confusion.</p><ul><li>We suggest using a <code class="inline">compare_</code> prefix for package version comparisons and <code class="inline">package_</code> to retrieve
a package version</li></ul><p>Additionally, when using the version comparison, it increases readability to explicitly mention
the values to compare against:</p><pre><code class="yaml">facts:
  - name: compare_package_corosync
    gatherer: package_version@v1
    argument: corosync,2.4.5

  - name: package_corosync
    gatherer: package_version@v1
    argument: corosync

  - name: package_sbd
    gatherer: package_version@v1
    argument: sbd

values:
  - name: greater_than_installed
    default: 1
  - name: lesser_than_installed
    default: -1
  - name: same_as_installed
    default: 0
  - name: expected_corosync_version
    default: &quot;2.4.5&quot;

expectations:
  - name: compare_package_corosync
    expect: facts.compare_package_corosync == values.greater_than_installed

  - name: package_corosync_is_the_expected_one
    expect: facts.package_corosync.first().version == values.expected_corosync_version

  - name: sbd_version_same_on_all_hosts
    expect_same: facts.package_sbd.first().version</code></pre><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">package_name</code></td><td style="text-align: left;">a list containing information about the installed versions of the rpm package</td></tr><tr><td style="text-align: left;"><code class="inline">package_name,2.4.5</code></td><td style="text-align: left;">an integer with a value of <code class="inline">-1</code>, <code class="inline">0</code> or <code class="inline">1</code> (see above)</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: package_corosync
    gatherer: package_version@v1
    argument: corosync

  - name: package_pacemaker
    gatherer: package_version@v1
    argument: pacemaker

  - name: multiple_sbd_versions_installed
    gatherer: package_version@v1
    argument: sbd

  - name: compare_package_corosync
    gatherer: package_version@v1
    argument: corosync,2.4.5

  ...</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// package_corosync
[
  #{
    &quot;version&quot;: &quot;2.4.5&quot;
  }
]

// package_pacemaker
[
  #{
    &quot;version&quot;: &quot;2.0.4+20200616.2deceaa3a&quot;
  }
]

// multiple_sbd_versions_installed
[
  #{
    &quot;version&quot;: &quot;1.5.1&quot; // latest installed version, not necessarily the newest one
  },
  #{
    &quot;version&quot;: &quot;1.5.2&quot;
  }
]

// compare_package_corosync
0</code></pre><span id="passwdv1"></span><h3 id="passwd-v1" class="section-heading">
  <a href="#passwd-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">passwd@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the /etc/passwd file, returning all entries available at the file.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: passwd
    gatherer: passwd@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">[
    #{
        &quot;description&quot;: &quot;bin&quot;,
        &quot;gid&quot;: 1,
        &quot;home&quot;: &quot;/bin&quot;,
        &quot;shell&quot;: &quot;/sbin/nologin&quot;,
        &quot;uid&quot;: 1,
        &quot;user&quot;: &quot;bin&quot;
    },
    #{
        &quot;description&quot;: &quot;Chrony Daemon&quot;,
        &quot;gid&quot;: 475,
        &quot;home&quot;: &quot;/var/lib/chrony&quot;,
        &quot;shell&quot;: &quot;/bin/false&quot;,
        &quot;uid&quot;: 474,
        &quot;user&quot;: &quot;chrony&quot;
    },
    #{
        &quot;description&quot;: &quot;Daemon&quot;,
        &quot;gid&quot;: 2,
        &quot;home&quot;: &quot;/sbin&quot;,
        &quot;shell&quot;: &quot;/sbin/nologin&quot;,
        &quot;uid&quot;: 2,
        &quot;user&quot;: &quot;daemon&quot;
    },
  ...
];</code></pre><span id="productsv1"></span><h3 id="products-v1" class="section-heading">
  <a href="#products-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">products@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the /etc/products.d/ folder files content. It returns the file contents mapped using the file name.
The XML content is returned as-is, just converted to a rhai object.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: products
    gatherer: products@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">#{
  &quot;Leap.prod&quot;: #{
    &quot;product&quot;: #{
      &quot;arch&quot;: &quot;x86_64&quot;,
      ...
      &quot;codestream&quot;: #{
        &quot;endoflife&quot;: &quot;2024-11-30&quot;,
        &quot;name&quot;: &quot;openSUSE Leap 15&quot;
      },
      ...
      &quot;name&quot;: &quot;Leap&quot;,
      &quot;productline&quot;: &quot;Leap&quot;,
      ...
      &quot;vendor&quot;: &quot;openSUSE&quot;,
      &quot;version&quot;: &quot;15.3&quot;
    }
  },
  &quot;baseproduct&quot;: #{
    &quot;product&quot;: #{
      &quot;arch&quot;: &quot;x86_64&quot;,
      ...
      &quot;codestream&quot;: #{
        &quot;endoflife&quot;: &quot;2024-11-30&quot;,
        &quot;name&quot;: &quot;openSUSE Leap 15&quot;
      },
     ...
      &quot;name&quot;: &quot;Leap&quot;,
      &quot;productline&quot;: &quot;Leap&quot;,
      ...
      &quot;vendor&quot;: &quot;openSUSE&quot;,
      &quot;version&quot;: &quot;15.3&quot;
    }
  }
} </code></pre><span id="sapcontrolv1"></span><h3 id="sapcontrol-v1" class="section-heading">
  <a href="#sapcontrol-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sapcontrol@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows access to certain webmethods that <code class="inline">sapcontrol</code> implements. An argument is required to specify which webmethod should be called. The communication with <code class="inline">sapcontrol</code> is created opening a unix socket connection using the file <code class="inline">/tmp/.sapstream5xx13</code>. The <a href="https://www.sap.com/documents/2016/09/0a40e60d-8b7c-0010-82c7-eda71af511fa.html">Sapcontrol Web Service Interface</a> documents the SOAP API interface, including all the possible values each of the fields could have, specifically helpful for enumerators like <code class="inline">dispstatus</code> in <code class="inline">GetProcessList</code> and <code class="inline">state/category</code> in <code class="inline">HACheckConfig</code> webmethod.</p><p>The return value is grouped by discovered SIDs, which include the list of command outputs for each instance in this system.</p><p>Supported webmethods:</p><ul><li><code class="inline">GetProcessList</code></li><li><code class="inline">GetSystemInstanceList</code></li><li><code class="inline">GetVersionInfo</code></li><li><code class="inline">HACheckConfig</code></li><li><code class="inline">HAGetFailoverConfig</code></li></ul><p>Example specification:</p><pre><code class="yaml">facts:
  - name: processes
    gatherer: sapcontrol@v1
    argument: GetProcessList

  - name: instances
    gatherer: sapcontrol@v1
    argument: GetSystemInstanceList</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// GetProcessList
#{
  &quot;NWP&quot;: [
    #{
      &quot;instance_nr&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;ERS10&quot;,
      &quot;output&quot;: [
        #{
          &quot;description&quot;: &quot;EnqueueReplicator&quot;,
          &quot;dispstatus&quot;: &quot;SAPControl-GREEN&quot;,
          &quot;elapsedtime&quot;: &quot;266:08:15&quot;,
          &quot;name&quot;: &quot;enrepserver&quot;,
          &quot;pid&quot;: 7221,
          &quot;starttime&quot;: &quot;2023 09 29 09:41:41&quot;,
          &quot;textstatus&quot;: &quot;Running&quot;
        }
      ]
    }
  ]
}

// GetSystemInstanceList
#{
  &quot;NWP&quot;: [
    #{
      &quot;instance_nr&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;ERS10&quot;,
      &quot;output&quot;: [
        #{
          &quot;dispstatus&quot;: &quot;SAPControl-GREEN&quot;,
          &quot;features&quot;: &quot;MESSAGESERVER|ENQUE&quot;,
          &quot;hostname&quot;: &quot;sapnwpas&quot;,
          &quot;http_port&quot;: 50013,
          &quot;https_port&quot;: 50014,
          &quot;instance_nr&quot;: 0,
          &quot;start_priority&quot;: &quot;1&quot;
        },
        #{
          &quot;dispstatus&quot;: &quot;SAPControl-GREEN&quot;,
          &quot;features&quot;: &quot;ENQREP&quot;,
          &quot;hostname&quot;: &quot;sapnwper&quot;,
          &quot;http_port&quot;: 51013,
          &quot;https_port&quot;: 51014,
          &quot;instance_nr&quot;: 10,
          &quot;start_priority&quot;: &quot;0.5&quot;
        },
        ...
      ]
    }
  ]
}

// GetVersionInfo
#{
  &quot;NWP&quot;: [
    #{
      &quot;instance_nr&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;ERS10&quot;,
      &quot;output&quot;: [
        #{
          &quot;architecture&quot;: &quot;linuxx86_64&quot;,
          &quot;build&quot;: &quot;optU (Oct 16 2021, 00:03:15)&quot;,
          &quot;changelist&quot;: &quot;2094654&quot;,
          &quot;filename&quot;: &quot;/usr/sap/NWP/ERS10/exe/sapstartsrv&quot;,
          &quot;patch&quot;: &quot;900&quot;,
          &quot;rks_compatibility_level&quot;: &quot;1&quot;,
          &quot;sap_kernel&quot;: &quot;753&quot;,
          &quot;time&quot;: &quot;2021 10 15 22:14:31&quot;
        },
        #{
          &quot;architecture&quot;: &quot;linuxx86_64&quot;,
          &quot;build&quot;: &quot;optU (Oct 16 2021, 00:03:15)&quot;,
          &quot;changelist&quot;: &quot;2094654&quot;,
          &quot;filename&quot;: &quot;/usr/sap/NWP/ERS10/exe/gwrd&quot;,
          &quot;patch&quot;: &quot;900&quot;,
          &quot;rks_compatibility_level&quot;: &quot;1&quot;,
          &quot;sap_kernel&quot;: &quot;753&quot;,
          &quot;time&quot;: &quot;2021 10 15 22:04:14&quot;
        },
        ...
      ]
    }
  ]
}

// HACheckConfig
#{
  &quot;NWP&quot;: [
    #{
      &quot;instance_nr&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;ERS10&quot;,
      &quot;output&quot;: [
        #{
          &quot;category&quot;: &quot;SAPControl-SAP-CONFIGURATION&quot;,
          &quot;comment&quot;: &quot;2 ABAP instances detected&quot;,
          &quot;description&quot;: &quot;Redundant ABAP instance configuration&quot;,
          &quot;state&quot;: &quot;SAPControl-HA-SUCCESS&quot;
        },
        #{
          &quot;category&quot;: &quot;SAPControl-SAP-CONFIGURATION&quot;,
          &quot;comment&quot;: &quot;0 Java instances detected&quot;,
          &quot;description&quot;: &quot;Redundant Java instance configuration&quot;,
          &quot;state&quot;: &quot;SAPControl-HA-SUCCESS&quot;
        },
        ...
      ]
    }
  ]
}

//HAGetFailoverConfig
#{
  &quot;NWP&quot;: [
    #{
      &quot;instance_nr&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;ERS10&quot;,
      &quot;output&quot;: #{
        &quot;ha_active&quot;: false,
        &quot;ha_active_nodes&quot;: &quot;&quot;,
        &quot;ha_documentation&quot;: &quot;&quot;,
        &quot;ha_nodes&quot;: [],
        &quot;ha_product_version&quot;: &quot;&quot;,
        &quot;ha_sap_interface_version&quot;: &quot;&quot;
      }
    }
  ]
}
</code></pre><span id="saphostctrlv1"></span><h3 id="saphostctrl-v1" class="section-heading">
  <a href="#saphostctrl-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">saphostctrl@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows access to certain webmethods that <code class="inline">saphostctrl</code> implements. An argument is required to specify
which webmethod should be called. This webmethod is passed to the <code class="inline">saphostctrl</code> command-line tool through the <code class="inline">-function</code> argument.</p><p>Supported webmethods:</p><ul><li><code class="inline">Ping</code></li><li><code class="inline">ListInstances</code></li></ul><p>A <code class="inline">Ping</code> call with a successful return should look like this:</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: ping
    gatherer: saphostctrl@v1
    argument: Ping

  - name: list_instances
    gatherer: saphostctrl@v1
    argument: ListInstances</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// ping
#{elapsed: 579770.0, status: &quot;SUCCESS&quot;}

// list_instances
[
    #{
        &quot;changelist&quot;: 1908545,
        &quot;hostname&quot;: &quot;vmhana01&quot;,
        &quot;instance&quot;: &quot;00&quot;,
        &quot;patch&quot;: 410,
        &quot;sapkernel&quot;: 753,
        &quot;system&quot;: &quot;PRD&quot;
    }
];</code></pre><span id="sapinstance_hostname_resolverv1"></span><h3 id="sapinstance_hostname_resolver-v1" class="section-heading">
  <a href="#sapinstance_hostname_resolver-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sapinstance_hostname_resolver@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer uses the filesystem to search for SAP systems using the discovered profile file names to get the virtual hostnames associated to each
instance of the sap system. It then attempts to resolve those hostnames to confirm that they are resolvable and afterwards a ping is attempted
to those hostnames. Keep in mind that ping could be disallowed through firewall rules so it should only be used for networks in which we know this is
not true.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: resolvability_check
    gatherer: sapinstance_hostname_resolver@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// 2 resolvable &amp; 1 non-resolvable hosts
#{
  &quot;NWP&quot;: [
    #{
      &quot;addresses&quot;: [
        &quot;2.1.1.82&quot;
      ],
      &quot;hostname&quot;: &quot;sapnwpas&quot;,
      &quot;instance_name&quot;: &quot;ASCS00&quot;,
      &quot;reachability&quot;: true
    }
  ],
  &quot;QAS&quot;: [
    #{
      &quot;addresses&quot;: [
        &quot;1.1.1.82&quot;
      ],
      &quot;hostname&quot;: &quot;sapqasas&quot;,
      &quot;instance_name&quot;: &quot;ASCS00&quot;,
      &quot;reachability&quot;: true
    },
    #{
      &quot;addresses&quot;: (),
      &quot;hostname&quot;: &quot;sapwaser&quot;,
      &quot;instance_name&quot;: &quot;ERS00&quot;,
      &quot;reachability&quot;: false
    }
  ]
}</code></pre><span id="sap_profilesv1"></span><h3 id="sap_profiles-v1" class="section-heading">
  <a href="#sap_profiles-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sap_profiles@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the latest SAP profile files content stored in <code class="inline">/sapmnt/&lt;SID&gt;/profile</code>.
The &quot;latest&quot; profile means that backed up files like <code class="inline">DEFAULT.1.PFL</code> or <code class="inline">some_profile.1</code> are excluded.
It returns the profile files and content grouped by SID in a key\value way.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: sap_profiles
    gatherer: sap_profiles@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">#{
  &quot;NWP&quot;: #{
    &quot;profiles&quot;: [
      #{
        &quot;content&quot;: #{
          &quot;SAPDBHOST&quot;: &quot;10.80.1.13&quot;,
          &quot;SAPGLOBALHOST&quot;: &quot;sapnwpas&quot;,
          &quot;SAPSYSTEMNAME&quot;: &quot;NWP&quot;,
          ...
        },
        &quot;name&quot;: &quot;DEFAULT.PFL&quot;,
        &quot;path&quot;: &quot;/sapmnt/NWP/profile/DEFAULT.PFL&quot;
      },
      #{
        &quot;content&quot;: #{
          &quot;DIR_CT_RUN&quot;: &quot;$(DIR_EXE_ROOT)$(DIR_SEP)$(OS_UNICODE)$(DIR_SEP)linuxx86_64&quot;,
          &quot;DIR_EXECUTABLE&quot;: &quot;$(DIR_INSTANCE)/exe&quot;,
          &quot;DIR_PROFILE&quot;: &quot;$(DIR_INSTALL)$(DIR_SEP)profile&quot;,
          ...
        },
        &quot;name&quot;: &quot;NWP_ASCS00_sapnwpas&quot;,
        &quot;path&quot;: &quot;/sapmnt/NWP/profile/NWP_ASCS00_sapnwpas&quot;
      },
      ...
    ]
  },
  &quot;NWD&quot;: #{
    &quot;profiles&quot;: [
      #{
        &quot;content&quot;: #{
          &quot;SAPDBHOST&quot;: &quot;10.85.1.13&quot;,
          &quot;SAPGLOBALHOST&quot;: &quot;sapnwdas&quot;,
          &quot;SAPSYSTEMNAME&quot;: &quot;NWD&quot;,
          ...
        },
        &quot;name&quot;: &quot;DEFAULT.PFL&quot;,
        &quot;path&quot;: &quot;/sapmnt/NWD/profile/DEFAULT.PFL&quot;
      },
      ...
    ]
  }
}</code></pre><span id="sapservicesv1"></span><h3 id="sapservices-v1" class="section-heading">
  <a href="#sapservices-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sapservices@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows access to the SAP services file content stored in <code class="inline">/usr/sap/sapservices</code>.
Each entry in the file is returned as a map, containing the SID, the instance number, the raw line content of the entry and
the kind of system used for startup, <code class="inline">systemctl</code> or <code class="inline">sapstartsrv</code>.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: sapservices
    gatherer: sapservices@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">[
  #{
    &quot;sid&quot;: &quot;HS1&quot;,
    &quot;kind&quot;: &quot;sapstartsrv&quot;,
    &quot;content&quot;: &quot;LD_LIBRARY_PATH=/usr/sap/HS1/HDB11/exe:$LD_LIBRARY_PATH;export LD_LIBRARY_PATH;/usr/sap/HS1/HDB11/exe/sapstartsrv pf=/usr/sap/HS1/SYS/profile/HS1_HDB11_s41db -D -u hs1adm&quot;,
    &quot;instance_nr&quot;: &quot;11&quot;
  },
  #{
    &quot;sid&quot;: &quot;S41&quot;,
    &quot;kind&quot;: &quot;systemctl&quot;,
    &quot;content&quot;: &quot;systemctl --no-ask-password start SAPS41_40&quot;,
    &quot;instance_nr&quot;: &quot;40&quot;
  },
]</code></pre><span id="saptunev1"></span><h3 id="saptune-v1" class="section-heading">
  <a href="#saptune-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">saptune@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows access to certain commands that <code class="inline">saptune</code> implements. An argument is required to specify
which argument should be used when calling <code class="inline">saptune</code>.</p><blockquote><p>Note: the gatherer will return the same JSON objects returned by saptune. The only transformation it applies is the snake casing of the keys.</p></blockquote><p>Supported arguments:</p><ul><li><code class="inline">status</code> (maps to <code class="inline">saptune --format json status --non-compliance-check</code>)</li><li><code class="inline">solution-verify</code> (maps to <code class="inline">saptune --format json solution verify</code>)</li><li><code class="inline">solution-list</code> (maps to <code class="inline">saptune --format json solution list</code>)</li><li><code class="inline">note-verify</code> (maps to <code class="inline">saptune --format json note verify</code>)</li><li><code class="inline">note-list</code> (maps to <code class="inline">saptune --format json note list</code>)</li></ul><p>A <code class="inline">status</code> call with a successful return should look like this:</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: status
    gatherer: saptune@v1
    argument: status</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// status
#{
  &quot;$schema&quot;: &quot;file:///usr/share/saptune/schemas/1.0/saptune_status.schema.json&quot;,
  &quot;argv&quot;: &quot;saptune --format json status&quot;,
  &quot;command&quot;: &quot;status&quot;,
  &quot;exit_code&quot;: 1,
  &quot;messages&quot;: [
    #{
      &quot;message&quot;: &quot;actions.go:85: ATTENTION: You are running a test version&quot;,
      &quot;priority&quot;: &quot;NOTICE&quot;
    }
  ],
  &quot;pid&quot;: 6593,
  &quot;publish_time&quot;: &quot;2023-09-15 15:15:14.599&quot;,
  &quot;result&quot;: #{
    &quot;configured_version&quot;: &quot;3&quot;,
    &quot;notes_applied&quot;: [
      &quot;1410736&quot;
    ],
    &quot;notes_applied_by_solution&quot;: [],
    &quot;notes_enabled&quot;: [
      &quot;1410736&quot;
    ],
    &quot;notes_enabled_additionally&quot;: [
      &quot;1410736&quot;
    ],
    &quot;notes_enabled_by_solution&quot;: [],
    &quot;package_version&quot;: &quot;3.1.0&quot;,
    &quot;remember_message&quot;: &quot;This is a reminder&quot;,
    &quot;services&quot;: #{
      &quot;sapconf&quot;: [],
      &quot;saptune&quot;: [
        &quot;disabled&quot;,
        &quot;inactive&quot;
      ],
      &quot;tuned&quot;: []
    },
    &quot;solution_applied&quot;: [],
    &quot;solution_enabled&quot;: [],
    &quot;staging&quot;: #{
      &quot;notes_staged&quot;: [],
      &quot;solutions_staged&quot;: [],
      &quot;staging_enabled&quot;: false
    },
    &quot;systemd_system_state&quot;: &quot;degraded&quot;,
    &quot;tuning_state&quot;: &quot;compliant&quot;,
    &quot;virtualization&quot;: &quot;kvm&quot;
  }
}</code></pre><span id="sbd_configv1"></span><h3 id="sbd_config-v1" class="section-heading">
  <a href="#sbd_config-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sbd_config@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer allows accessing the information contained in <code class="inline">/etc/sysconfig/sbd</code></p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">SBD_PACEMAKER</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">SBD_STARTMODE</code></td><td style="text-align: left;">extracted value from the config</td></tr><tr><td style="text-align: left;"><code class="inline">SBD_DEVICE</code></td><td style="text-align: left;">extracted value from the config</td></tr></tbody></table><p>Example specification:</p><pre><code class="yaml">facts:
  - name: sbd_pacemaker
    gatherer: sbd_config@v1
    argument: SBD_PACEMAKER

  - name: sbd_startmode
    gatherer: sbd_config@v1
    argument: SBD_STARTMODE

  - name: sbd_device
    gatherer: sbd_config@v1
    argument: SBD_DEVICE</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// sbd_pacemaker
&quot;yes&quot;;

// sbd_startmode
&quot;always&quot;;

// sbd_device
&quot;/dev/vdc;/dev/vdb&quot;;</code></pre><span id="sbd_dumpv1"></span><h3 id="sbd_dump-v1" class="section-heading">
  <a href="#sbd_dump-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sbd_dump@v1</span>
</h3>
<p><strong>Argument required</strong>: no.</p><p>This gatherer allows accessing the sbd dump command output data.</p><p>It executes the <code class="inline">sbd -d &lt;device&gt; dump</code> command in all devices configured in the <code class="inline">SBD_DEVICE</code> field on <code class="inline">/etc/sysconfig/sbd</code> and aggregates results in only one fact.</p><p>Note that:</p><ul><li>no arguments are required</li><li>if any of the dumps fail, a fact error is returned</li></ul><p>Dumped keys (<code class="inline">Timeout (watchdog)</code>, <code class="inline">Timeout (msgwait)</code>, <code class="inline">Number of slots</code>, etc) are sanitized to simplify their access and usage in the expression language.</p><p>Example specification:</p><pre><code class="yaml">facts:
  - name: sbd_devices_dump
    gatherer: sbd_dump@v1</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// sbd_devices_dump
#{
    &quot;/dev/vdc&quot;: #{
        header_version: 2.1,
        number_of_slots: 255,
        sector_size: 512,
        timeout_allocate: 2,
        timeout_loop: 1,
        timeout_msgwait: 10,
        timeout_watchdog: 5,
        uuid: &quot;69048391-c647-4b34-a03a-f704f5cc2258&quot;
    }
};</code></pre><p>For extra information refer to <a href="https://github.com/trento-project/agent/blob/main/internal/factsengine/gatherers/sbddump_test.go">trento-project/agent/../gatherers/sbddump_test.go</a></p><span id="sysctlv1"></span><h3 id="sysctl-v1" class="section-heading">
  <a href="#sysctl-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">sysctl@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>Gather sysctl output. It takes a sysctl key as argument and it returns the value of the requested key or a map if a partial key is provided.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">vm.swappiness</code></td><td style="text-align: left;">corresponding value returned by sysctl</td></tr><tr><td style="text-align: left;"><code class="inline">debug</code></td><td style="text-align: left;">a map containing all the keys starting with `debug.``</td></tr></tbody></table><pre><code class="yaml">facts:
  - name: vm_swappiness
    gatherer: sysctl@v1
    argument: vm.swappiness

  - name: debug
    gatherer: sysctl
    argument: debug</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// vm_swapiness
60;

// debug
#{
  &quot;exception-trace&quot;: 1,
  &quot;kprobes-optimization&quot;: 1
};</code></pre><span id="systemdv1"></span><h3 id="systemd-v1" class="section-heading">
  <a href="#systemd-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">systemd@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>Gather systemd units state. It returns an <code class="inline">active/inactive</code> string.
If the service is disabled or it does not exist, <code class="inline">inactive</code> is returned.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">trento-agent</code></td><td style="text-align: left;">state of the systemd unit</td></tr></tbody></table><pre><code class="yaml">facts:
  - name: sbd_state
    gatherer: systemd@v1
    argument: sbd

  - name: corosync_state
    gatherer: systemd@v1
    argument: corosync</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// sbd_state
&quot;active&quot;;

// corosync_state
&quot;inactive&quot;;</code></pre><span id="systemdv2"></span><h3 id="systemd-v2" class="section-heading">
  <a href="#systemd-v2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">systemd@v2</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>Gather systemd units information. It returns an object with multiple fields about the systemd unit.</p><p>The provided unit name must include the extension, such as <code class="inline">.service</code> or <code class="inline">.mount</code>.</p><p>Only a subset of properties are returned. Additional information about these is available in
the <a href="https://www.man7.org/linux/man-pages/man5/org.freedesktop.systemd1.5.html#UNIT_OBJECTS">systemd</a> man pages,
with some detailed description in the <code class="inline">Properties</code> sub-chapter.</p><p>Example arguments:</p><table><thead><tr><th style="text-align: left;">Name</th><th style="text-align: left;">Return value</th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">trento-agent.service</code></td><td style="text-align: left;">systemd unit information</td></tr></tbody></table><pre><code class="yaml">facts:
  - name: corosync
    gatherer: systemd@v2
    argument: corosync.service

  - name: not_found
    gatherer: systemd@v2
    argument: unknown.service</code></pre><p>Example output (in Rhai):</p><pre><code class="ts">// corosync
#{
  &quot;active_state&quot;: &quot;inactive&quot;,
  &quot;description&quot;: &quot;Corosync Cluster Engine&quot;,
  &quot;id&quot;: &quot;corosync.service&quot;,
  &quot;load_state&quot;: &quot;loaded&quot;,
  &quot;need_daemon_reload&quot;: false,
  &quot;unit_file_preset&quot;: &quot;disabled&quot;,
  &quot;unit_file_state&quot;: &quot;disabled&quot;
}

// not_found
#{
  &quot;active_state&quot;: &quot;inactive&quot;,
  &quot;description&quot;: &quot;unknown.service&quot;,
  &quot;id&quot;: &quot;unknown.service&quot;,
  &quot;load_state&quot;: &quot;not-found&quot;,
  &quot;need_daemon_reload&quot;: false,
  &quot;unit_file_preset&quot;: &quot;&quot;,
  &quot;unit_file_state&quot;: &quot;&quot;
}
</code></pre><span id="verify_passwordv1"></span><h3 id="verify_password-v1" class="section-heading">
  <a href="#verify_password-v1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">verify_password@v1</span>
</h3>
<p><strong>Argument required</strong>: yes.</p><p>This gatherer determines whether a given user has its password still set to an unsafe password.
It returns <code class="inline">true</code> if the password matches a password in the list of unsafe passwords, <code class="inline">false</code> otherwise.</p><p>Specification examples:</p><pre><code class="yaml">facts:
  - name: hacluster_has_default_password
    gatherer: verify_password@v1
    argument: hacluster</code></pre><p>For the argument, only whitelisted users are allowed. Currently whitelisted usernames:</p><ul><li><code class="inline">hacluster</code></li></ul><p>List of unsafe passwords:</p><ul><li><code class="inline">linux</code></li></ul><p>Example output (in Rhai):</p><pre><code class="ts">// hacluster_has_default_password
true;</code></pre>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="expression_language.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          â† Previous Page
        </span>
        <span class="title">
Expression Language
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="hack_on_wanda.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page â†’
        </span>
        <span class="title">
Hack on Wanda
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="Wanda.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.37.1) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
